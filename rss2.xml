<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Togal</title>
    <link>http://blog.togal.org/</link>
    <atom:link href="/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>世间并无普世的成功定律，但却有普世的失败定律，你只要精通这些失败定律并尽量避免，那么，无疑就离自我成就更近一大步！</description>
    <pubDate>Mon, 06 Nov 2017 10:51:43 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>flume interceptor</title>
      <link>http://blog.togal.org/2017/11/06/flume%E5%90%84%E7%A7%8Ddemo/</link>
      <guid>http://blog.togal.org/2017/11/06/flume%E5%90%84%E7%A7%8Ddemo/</guid>
      <pubDate>Mon, 06 Nov 2017 09:38:20 GMT</pubDate>
      <description>
      
        &lt;h4 id=&quot;flume-interceptor&quot;&gt;&lt;a href=&quot;#flume-interceptor&quot; class=&quot;headerlink&quot; title=&quot;flume interceptor&quot;&gt;&lt;/a&gt;flume interceptor&lt;/h4&gt;&lt;h5 id=&quot;refer
      
      </description>
      
      <content:encoded><![CDATA[<h4 id="flume-interceptor"><a href="#flume-interceptor" class="headerlink" title="flume interceptor"></a>flume interceptor</h4><h5 id="refer-https-flume-apache-org-FlumeUserGuide-html"><a href="#refer-https-flume-apache-org-FlumeUserGuide-html" class="headerlink" title="refer:https://flume.apache.org/FlumeUserGuide.html"></a>refer:<a href="https://flume.apache.org/FlumeUserGuide.html" target="_blank" rel="external">https://flume.apache.org/FlumeUserGuide.html</a></h5><p><code>软件环境：flume1.8版本</code></p>
<h4 id="一、官方集成"><a href="#一、官方集成" class="headerlink" title="一、官方集成"></a>一、官方集成</h4><h5 id="添加host主机和时间戳timestamp到headers头"><a href="#添加host主机和时间戳timestamp到headers头" class="headerlink" title="添加host主机和时间戳timestamp到headers头"></a>添加host主机和时间戳timestamp到headers头</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">a1.sources = r1</div><div class="line">a1.sinks = k1</div><div class="line">a1.channels = c1</div><div class="line">a1.sources.r1.interceptors = i1 i2</div><div class="line">a1.sources.r1.interceptors.i1.type = org.apache.flume.interceptor.HostInterceptor$Builder</div><div class="line">a1.sources.r1.interceptors.i1.preserveExisting = false</div><div class="line">a1.sources.r1.interceptors.i1.hostHeader = hostname</div><div class="line">a1.sources.r1.interceptors.i2.type = org.apache.flume.interceptor.TimestampInterceptor$Builder</div><div class="line">a1.sinks.k1.filePrefix = FlumeData.%&#123;CollectorHost&#125;.%Y-%m-%d</div><div class="line">a1.sinks.k1.channel = c1</div></pre></td></tr></table></figure>
<p>运行结果：</p>
<p><img src="http://owcr8i5la.bkt.clouddn.com/201711061750_5.png" alt=""></p>
<p>timestamp 简写配置:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">a1.sources = r1</div><div class="line">a1.channels = c1</div><div class="line">a1.sources.r1.channels =  c1</div><div class="line">a1.sources.r1.type = seq</div><div class="line">a1.sources.r1.interceptors = i1</div><div class="line">a1.sources.r1.interceptors.i1.type = timestamp</div></pre></td></tr></table></figure>
<p>host 简写配置:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">a1.sources = r1</div><div class="line">a1.channels = c1</div><div class="line">a1.sources.r1.interceptors = i1</div><div class="line">a1.sources.r1.interceptors.i1.type = host</div></pre></td></tr></table></figure>
<h4 id="二、实现demo"><a href="#二、实现demo" class="headerlink" title="二、实现demo"></a>二、实现demo</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Interceptor</span> </span>&#123;</div><div class="line"> </div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">initialize</span><span class="params">()</span></span>;</div><div class="line"> </div><div class="line">    <span class="function">Event <span class="title">intercept</span><span class="params">(Event event)</span></span>;</div><div class="line"> </div><div class="line">    <span class="function">List&lt;Event&gt; <span class="title">intercept</span><span class="params">(List&lt;Event&gt; list)</span></span>;</div><div class="line"> </div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>;</div><div class="line"> </div><div class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">interface</span> <span class="title">Builder</span> <span class="keyword">extends</span> <span class="title">Configurable</span> </span>&#123;</div><div class="line">        <span class="function">Interceptor <span class="title">build</span><span class="params">()</span></span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><em>1、public void initialize()运行前的初始化，一般不需要实现（上面的几个都没实现这个方法）</em>()</li>
<li><em>2、public Event intercept(Event event)处理单个event；</em></li>
<li><em>3、public List<event> intercept(List<event> events)批量处理event，实际上市循环调用上面的2；</event></event></em></li>
<li><em>4、public void close()可以做一些清理工作，上面几个也都没有实现这个方法；</em></li>
<li><em>5、 public interface Builder extends Configurable 构建Interceptor对象，外部使用这个Builder来获取Interceptor对象。</em></li>
</ul>
<p><strong>如果要自己定制，必须要完成上面的2,3,5。</strong></p>
<p>项目运行需要导入<strong><em>对应flume版本</em></strong>的三个jar包:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">flume-ng-configuration-1.8.0.jar</div><div class="line">flume-ng-core-1.8.0.jar</div><div class="line">flume-ng-sdk-1.8.0.jar</div></pre></td></tr></table></figure>
<h5 id="1-每个Event添加统计行数"><a href="#1-每个Event添加统计行数" class="headerlink" title="1.每个Event添加统计行数"></a>1.每个Event添加统计行数</h5><p>CountInterceptor.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> org.togal.interceptor;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.apache.flume.interceptor.Interceptor;</div><div class="line"><span class="keyword">import</span> org.apache.flume.Context;</div><div class="line"><span class="keyword">import</span> org.apache.flume.Event;</div><div class="line"><span class="keyword">import</span> java.util.concurrent.atomic.AtomicLong;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CountInterceptor</span> <span class="keyword">implements</span> <span class="title">Interceptor</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">final</span> String headerKey;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String CONF_HEADER_KEY = <span class="string">"header"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_HEADER = <span class="string">"count"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AtomicLong currentCount;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">CountInterceptor</span><span class="params">(Context ctx)</span> </span>&#123;</div><div class="line">        headerKey = ctx.getString(CONF_HEADER_KEY,DEFAULT_HEADER);</div><div class="line">        currentCount = <span class="keyword">new</span> AtomicLong(<span class="number">0</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initialize</span><span class="params">()</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Event <span class="title">intercept</span><span class="params">(Event event)</span> </span>&#123;</div><div class="line">        <span class="keyword">long</span> count = currentCount.incrementAndGet();</div><div class="line">        event.getHeaders().put(headerKey,String.valueOf(count));</div><div class="line">        <span class="keyword">return</span> event;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Event&gt; <span class="title">intercept</span><span class="params">(List&lt;Event&gt; events)</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (Event e:events) &#123;</div><div class="line">            intercept(e);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> events;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">CounterInterceptorBuilder</span> <span class="keyword">implements</span> <span class="title">Builder</span> </span>&#123;</div><div class="line">        <span class="keyword">private</span> Context ctx;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> Interceptor <span class="title">build</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> CountInterceptor(ctx);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">            <span class="keyword">this</span>.ctx = context;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>conf配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a1.sources.r1.interceptors.i1.type=org.togal.interceptor.CountInterceptor$CounterInterceptorBuilder</div></pre></td></tr></table></figure>
<p>注意点:</p>
<p><strong>Builder继承名字要对上</strong></p>
<p>运行结果:</p>
<p><img src="http://owcr8i5la.bkt.clouddn.com/201711061819_666.png" alt=""></p>
<h5 id="2-添加主机名"><a href="#2-添加主机名" class="headerlink" title="2.添加主机名"></a>2.添加主机名</h5><p>CustomHostInterceptor.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> org.togal.interceptor;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.apache.flume.interceptor.Interceptor;</div><div class="line"><span class="keyword">import</span> org.apache.flume.Context;</div><div class="line"><span class="keyword">import</span> org.apache.flume.Event;</div><div class="line"><span class="keyword">import</span> org.apache.flume.FlumeException;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.concurrent.atomic.AtomicLong;</div><div class="line"><span class="keyword">import</span> java.net.InetAddress;</div><div class="line"><span class="keyword">import</span> java.net.UnknownHostException;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomHostInterceptor</span></span></div><div class="line"><span class="class"><span class="keyword">implements</span> <span class="title">Interceptor</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> String hostValue;</div><div class="line"><span class="keyword">private</span> String hostHeader;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">CustomHostInterceptor</span><span class="params">(String hostHeader)</span></span>&#123;</div><div class="line"><span class="keyword">this</span>.hostHeader = hostHeader;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initialize</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="comment">// At interceptor start up</span></div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">    hostValue =</div><div class="line">            InetAddress.getLocalHost().getHostName();</div><div class="line">&#125; <span class="keyword">catch</span> (UnknownHostException e) &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> FlumeException(<span class="string">"Cannot get Hostname"</span>, e);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> Event <span class="title">intercept</span><span class="params">(Event event)</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="comment">// This is the event's body</span></div><div class="line">String body = <span class="keyword">new</span> String(event.getBody());</div><div class="line"></div><div class="line"><span class="comment">// These are the event's headers</span></div><div class="line">Map&lt;String, String&gt; headers = event.getHeaders();</div><div class="line"></div><div class="line"><span class="comment">// Enrich header with hostname</span></div><div class="line">headers.put(hostHeader, hostValue);</div><div class="line"></div><div class="line"><span class="comment">// Let the enriched event go</span></div><div class="line"><span class="keyword">return</span> event;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;Event&gt; <span class="title">intercept</span><span class="params">(List&lt;Event&gt; events)</span> </span>&#123;</div><div class="line"></div><div class="line">List&lt;Event&gt; interceptedEvents =</div><div class="line">        <span class="keyword">new</span> ArrayList&lt;Event&gt;(events.size());</div><div class="line"><span class="keyword">for</span> (Event event : events) &#123;</div><div class="line">    <span class="comment">// Intercept any event</span></div><div class="line">    Event interceptedEvent = intercept(event);</div><div class="line">    interceptedEvents.add(interceptedEvent);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">return</span> interceptedEvents;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="comment">// At interceptor shutdown</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span></span></div><div class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">Interceptor</span>.<span class="title">Builder</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> String hostHeader;</div><div class="line">	</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">	    <span class="comment">// Retrieve property from flume conf</span></div><div class="line">	    hostHeader = context.getString(<span class="string">"hostHeader"</span>);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> Interceptor <span class="title">build</span><span class="params">()</span> </span>&#123;</div><div class="line">	    <span class="keyword">return</span> <span class="keyword">new</span> CustomHostInterceptor(hostHeader);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>conf配置:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">a1.sources.r1.interceptors.i1.type = org.togal.interceptor.CustomHostInterceptor$Builder</div><div class="line">a1.sources.r1.interceptors.i1.hostHeader = hostname</div></pre></td></tr></table></figure>
<p>运行结果:</p>
<p><img src="http://owcr8i5la.bkt.clouddn.com/201711061831_972.png" alt=""></p>
]]></content:encoded>
      
      <comments>http://blog.togal.org/2017/11/06/flume%E5%90%84%E7%A7%8Ddemo/#disqus_thread</comments>
    </item>
    
    <item>
      <title>flume学习</title>
      <link>http://blog.togal.org/2017/11/01/flume%E5%AD%A6%E4%B9%A0/</link>
      <guid>http://blog.togal.org/2017/11/01/flume%E5%AD%A6%E4%B9%A0/</guid>
      <pubDate>Wed, 01 Nov 2017 08:47:20 GMT</pubDate>
      <description>
      
        &lt;h3 id=&quot;一、理论知识&quot;&gt;&lt;a href=&quot;#一、理论知识&quot; class=&quot;headerlink&quot; title=&quot;一、理论知识&quot;&gt;&lt;/a&gt;一、理论知识&lt;/h3&gt;&lt;h4 id=&quot;1-Flume使用的前提&quot;&gt;&lt;a href=&quot;#1-Flume使用的前提&quot; class=&quot;head
      
      </description>
      
      <content:encoded><![CDATA[<h3 id="一、理论知识"><a href="#一、理论知识" class="headerlink" title="一、理论知识"></a>一、理论知识</h3><h4 id="1-Flume使用的前提"><a href="#1-Flume使用的前提" class="headerlink" title="1. Flume使用的前提"></a>1. Flume使用的前提</h4><p> Flume使用 java编写，其需要运行在 Java1.6或更高版本之上。</p>
<h4 id="2-Flume的定义"><a href="#2-Flume的定义" class="headerlink" title="2. Flume的定义"></a>2. Flume的定义</h4><p> Flume是一个分布式、可靠、高效可用的海量日志采集、聚合和传输系统，支持在系统中定制各类数据发送方，用于搜集数据；同时，flume提供对数据进行加单处理，并写到各种数据接受方（可定制）的能力。<br>核心一句话：将数据从数据源收集过来，再送到目的地。为了保证输送一定成功，在送到目的地之前，会先缓冲数据，待数据真正到的目的地后，删除自己缓冲的数据。</p>
<h4 id="3-组件及作用"><a href="#3-组件及作用" class="headerlink" title="3. 组件及作用"></a>3. 组件及作用</h4><p>source：从client端收集数据，传递个channel。直接读取：文件source的有两种方式</p>
<ul>
<li>ExecuteSource:以运行linux命令的方式，持续的输出最新的数据，如tail –f 文件名指令，在这种方式下取的文件名必须是指定的。</li>
</ul>
<ul>
<li>SpoolSource：检测配置的目录下新增的文件，并将文件中的数据读取出来。</li>
</ul>
<p>channel：缓冲数据，连接sources和sinks，有点像队列。类型有MemoryChannel，JDBC Channel，FileChannel等。</p>
<p>sink：从channel收集数据，运行一个独立线程。可以向文件系统、数据库、hadoop存储数据。</p>
<p>在日志数据较少时，可以将数据存储在文件系统中，并且设定一定的时间间隔保存数据。<br>  在日志数据较多时，可以将相应的日志存储到hadoop中，便于日后进行相应的数据分析。<br>组件名称功能介绍</p>
<p><img src="http://owcr8i5la.bkt.clouddn.com/201711011652_768.png" alt=""></p>
<ul>
<li>源将事件写到一个多或者多个通道中。</li>
<li>接收器只从一个通道接收事件。</li>
<li>代理可能会有多个源、通道与接收器</li>
<li>Event是flume数据传输的基本单元，flume以事件的形式将数据从源头传送到目的地。</li>
<li><u>一个 Event 由 Map<string,string>Headers 和 byte[] body 组成，其中 Headers 保存了 Event 的属性，body 保存了 Event 的内容。</string,string></u></li>
<li>Source:负责接收events或通过特殊机制产生events，并将events批量的放到一个或多个channels。</li>
<li>Channel位于sources和sinks之间，用于缓存进来的events，当sink成功的将events发送到下一跳的channel或最终目的，events从channel移除。</li>
<li>Sink：负责将events传输到吓一跳或最终目的，成功完成后将events从channel移除。</li>
</ul>
<p>Flume Source支持的类型：</p>
<p><img src="http://owcr8i5la.bkt.clouddn.com/201711011655_874.png" alt=""></p>
<p>Flume Channel支持的类型：</p>
<p><img src="http://owcr8i5la.bkt.clouddn.com/201711011656_690.png" alt=""></p>
<p>Flume Sink支持的类型：</p>
<p><img src="http://owcr8i5la.bkt.clouddn.com/201711011656_52.png" alt=""></p>
<h4 id="4-Apache-Avro-与-Thrift-比较"><a href="#4-Apache-Avro-与-Thrift-比较" class="headerlink" title="4. Apache Avro 与 Thrift 比较"></a>4. Apache Avro 与 Thrift 比较</h4><p><code>Avro和Thrift都是跨语言，基于二进制的高性能的通讯中间件. 它们都提供了数据序列化的功能和RPC服务. 总体功能上类似，但是哲学不一样. Thrift出自Facebook用于后台各个服务间的通讯,Thrift的设计强调统一的编程接口的多语言通讯框架. Avro出自Hadoop之父Doug Cutting, 在Thrift已经相当流行的情况下Avro的推出，其目标不仅是提供一套类似Thrift的通讯中间件更是要建立一个新的，标准性的云计算的数据交换和存储的Protocol。 这个和Thrift的理念不同，Thrift认为没有一个完美的方案可以解决所有问题，因此尽量保持一个Neutral框架，插入不同的实现并互相交互。而Avro偏向实用，排斥多种方案带来的 可能的混乱，主张建立一个统一的标准，并不介意采用特定的优化。Avro的创新之处在于融合了显式,declarative的Schema和高效二进制的数据表达，强调数据的自我描述，克服了以往单纯XML或二进制系统的缺陷。Avro对Schema动态加载功能，是Thrift编程接口所不具备的，符合了Hadoop上的Hive/Pig及NOSQL 等既属于ad hoc，又追求性能的应用需求.</code></p>
<ul>
<li><strong><em>语言绑定</em></strong></li>
</ul>
<p>目前阶段Thrift比Avro支持的语言更丰富.</p>
<p> Thrift:  C++, C#, Cocoa, Erlang, Haskell, Java, Ocami, Perl, PHP, Python, Ruby, Smalltalk.</p>
<p> Avro:   C, C++, Java, Python, Ruby, PHP.</p>
<ul>
<li><p><strong><em>数据类型</em></strong></p>
<p>从常见的数据类型的角度来说， Avro和Thrift非常接近，功能上并没有什么区别。</p>
</li>
</ul>
<hr>
<h3 id="二、安装"><a href="#二、安装" class="headerlink" title="二、安装"></a>二、安装</h3><h4 id="1-下载JDK"><a href="#1-下载JDK" class="headerlink" title="1.下载JDK"></a>1.下载JDK</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget --no-check-certificate --no-cookies --header "Cookie: oraclelicense=accept-securebackup-cookie" http://download.oracle.com/otn-pub/java/jdk/8u152-b16/aa0333dd3019491ca4f6ddbe78cdb6d0/jdk-8u152-linux-x64.tar.gz</div></pre></td></tr></table></figure>
<h4 id="2-下载flume"><a href="#2-下载flume" class="headerlink" title="2.下载flume"></a>2.下载flume</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget http://mirrors.tuna.tsinghua.edu.cn/apache/flume/1.8.0/apache-flume-1.8.0-bin.tar.gz</div></pre></td></tr></table></figure>
<h4 id="3-添加到全局环境变量"><a href="#3-添加到全局环境变量" class="headerlink" title="3.添加到全局环境变量"></a>3.添加到全局环境变量</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>vim /etc/profile</div><div class="line"><span class="meta">#</span>添加以下内容</div><div class="line">JAVA_HOME=/usr/local/jdk1.8.0_152</div><div class="line">FLUME_HOME=/usr/local/apache-flume-1.8.0</div><div class="line">export CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib/dt.jar:$&#123;JAVA_HOME&#125;/lib/tools.jar</div><div class="line">export PATH=.:$&#123;PATH&#125;:$&#123;GOHOME&#125;/bin:$&#123;JAVA_HOME&#125;/bin:$&#123;FLUME_HOME&#125;/bin</div></pre></td></tr></table></figure>
<h4 id="4-验证安装"><a href="#4-验证安装" class="headerlink" title="4.验证安装"></a>4.验证安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>验证JDK</div><div class="line"><span class="meta">$</span> cat Test.java </div><div class="line">public class Test &#123; </div><div class="line">    public static void main(String args[]) &#123; </div><div class="line">        System.out.println("A new jdk test !"); </div><div class="line">    &#125; </div><div class="line">&#125; </div><div class="line"><span class="meta">$</span> javac Test.java</div><div class="line"><span class="meta">$</span> java Test</div><div class="line">A new jdk test !</div></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>验证flume</div><div class="line"><span class="meta">$</span> flume-ng version</div><div class="line">Flume 1.8.0</div><div class="line">Source code repository: https://git-wip-us.apache.org/repos/asf/flume.git</div><div class="line">Revision: 99f591994468633fc6f8701c5fc53e0214b6da4f</div><div class="line">Compiled by denes on Fri Sep 15 14:58:00 CEST 2017</div><div class="line">From source with checksum fbb44c8c8fb63a49be0a59e27316833d</div></pre></td></tr></table></figure>
<p>输出”A new jdk test !”和flume版本表示成功！</p>
<h3 id="三、运用"><a href="#三、运用" class="headerlink" title="三、运用"></a>三、运用</h3><p>。。。。。</p>
<p><a href="https://flume.apache.org/FlumeUserGuide.html" target="_blank" rel="external">flume官方指南</a></p>
]]></content:encoded>
      
      <comments>http://blog.togal.org/2017/11/01/flume%E5%AD%A6%E4%B9%A0/#disqus_thread</comments>
    </item>
    
    <item>
      <title>Linux下使用wget从官网上下载Oracle JDK</title>
      <link>http://blog.togal.org/2017/10/31/Linux%E4%B8%8B%E4%BD%BF%E7%94%A8wget%E4%BB%8E%E5%AE%98%E7%BD%91%E4%B8%8A%E4%B8%8B%E8%BD%BDOracle-JDK/</link>
      <guid>http://blog.togal.org/2017/10/31/Linux%E4%B8%8B%E4%BD%BF%E7%94%A8wget%E4%BB%8E%E5%AE%98%E7%BD%91%E4%B8%8A%E4%B8%8B%E8%BD%BDOracle-JDK/</guid>
      <pubDate>Tue, 31 Oct 2017 02:21:05 GMT</pubDate>
      <description>
      
        &lt;h5 id=&quot;由于版权原因，Linux发行版并没有包含官方版的Oracle-JDK，必须自己从官网上下载安装。Oracle官网用Cookie限制下载方式，使眼下只能用浏览器进行下载，使用其他方式可能会导致下载失败。但是你有张良计，我有过墙梯。这种终极俩在广大劳动人民面前就如腐萤
      
      </description>
      
      <content:encoded><![CDATA[<h5 id="由于版权原因，Linux发行版并没有包含官方版的Oracle-JDK，必须自己从官网上下载安装。Oracle官网用Cookie限制下载方式，使眼下只能用浏览器进行下载，使用其他方式可能会导致下载失败。但是你有张良计，我有过墙梯。这种终极俩在广大劳动人民面前就如腐萤比皓月，粟米比沧海。斗转腾挪之后总归找到一些下载方法，本文以wget为例，收录几种下载的技巧，抛砖引玉。"><a href="#由于版权原因，Linux发行版并没有包含官方版的Oracle-JDK，必须自己从官网上下载安装。Oracle官网用Cookie限制下载方式，使眼下只能用浏览器进行下载，使用其他方式可能会导致下载失败。但是你有张良计，我有过墙梯。这种终极俩在广大劳动人民面前就如腐萤比皓月，粟米比沧海。斗转腾挪之后总归找到一些下载方法，本文以wget为例，收录几种下载的技巧，抛砖引玉。" class="headerlink" title="由于版权原因，Linux发行版并没有包含官方版的Oracle JDK，必须自己从官网上下载安装。Oracle官网用Cookie限制下载方式，使眼下只能用浏览器进行下载，使用其他方式可能会导致下载失败。但是你有张良计，我有过墙梯。这种终极俩在广大劳动人民面前就如腐萤比皓月，粟米比沧海。斗转腾挪之后总归找到一些下载方法，本文以wget为例，收录几种下载的技巧，抛砖引玉。"></a>由于版权原因，Linux发行版并没有包含官方版的Oracle JDK，必须自己从官网上下载安装。Oracle官网用Cookie限制下载方式，使眼下只能用浏览器进行下载，使用其他方式可能会导致下载失败。但是你有张良计，我有过墙梯。这种终极俩在广大劳动人民面前就如腐萤比皓月，粟米比沧海。斗转腾挪之后总归找到一些下载方法，本文以wget为例，收录几种下载的技巧，抛砖引玉。</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>FOR JDK 8u60</div><div class="line"></div><div class="line"><span class="meta">#</span>RPM:</div><div class="line"></div><div class="line">wget --no-check-certificate --no-cookies --header "Cookie: oraclelicense=accept-securebackup-cookie" http://download.oracle.com/otn-pub/java/jdk/8u60-b27/jdk-8u60-linux-x64.rpm</div><div class="line"></div><div class="line"><span class="meta">#</span>tar.gz:</div><div class="line"></div><div class="line">wget --no-check-certificate --no-cookies --header "Cookie: oraclelicense=accept-securebackup-cookie"  http://download.oracle.com/otn-pub/java/jdk/8u60-b27/jdk-8u60-linux-x64.tar.gz</div><div class="line"></div><div class="line"><span class="meta">#</span>FOR JDK 8u65</div><div class="line"></div><div class="line"><span class="meta">#</span>tar.gz</div><div class="line"></div><div class="line">wget --no-check-certificate -c --header "Cookie: oraclelicense=accept-securebackup-cookie" http://download.oracle.com/otn-pub/java/jdk/8u65-b17/jdk-8u65-linux-x64.tar.gz</div></pre></td></tr></table></figure>
<ul>
<li>–no-check-certificate</li>
</ul>
<h5 id="Only-required-with-wget-1-12-and-earlier-which-do-not-support-Subject-Alternative-Name-SAN-certificates-mainly-Red-Hat-Enterprise-Linux-6-x-and-friends-such-as-CentOS-1-13-wasreleased-in-August-2011"><a href="#Only-required-with-wget-1-12-and-earlier-which-do-not-support-Subject-Alternative-Name-SAN-certificates-mainly-Red-Hat-Enterprise-Linux-6-x-and-friends-such-as-CentOS-1-13-wasreleased-in-August-2011" class="headerlink" title="Only required with wget 1.12 and earlier, which do not support Subject Alternative Name (SAN) certificates (mainly Red Hat Enterprise Linux 6.x and friends, such as CentOS). 1.13 wasreleased in August 2011."></a>Only required with wget 1.12 and earlier, which do not support Subject Alternative Name (SAN) certificates (mainly Red Hat Enterprise Linux 6.x and friends, such as CentOS). 1.13 wasreleased in August 2011.</h5><h5 id="To-see-the-current-version-use-wget-–version-head-1"><a href="#To-see-the-current-version-use-wget-–version-head-1" class="headerlink" title="To see the current version, use: wget –version | head -1"></a>To see the current version, use: wget –version | head -1</h5><ul>
<li>-c / –continue</li>
</ul>
<h5 id="Allows-continuing-an-unfinished-download"><a href="#Allows-continuing-an-unfinished-download" class="headerlink" title="Allows continuing an unfinished download."></a>Allows continuing an unfinished download.</h5><ul>
<li>–header “Cookie: oraclelicense=accept-securebackup-cookie”</li>
</ul>
<h5 id="Since-15th-March-2014-this-cookie-is-provided-to-the-user-after-accepting-the-License-Agreementand-is-necessary-for-accessing-the-Java-packages-in-download-oracle-com-The-previous-and-first-implementation-in-27th-March-2012-made-use-of-the-cookie-gpw-e24-http-3A-2F-2Fwww-oracle-com-…-Both-cases-remain-unannounced-to-the-public"><a href="#Since-15th-March-2014-this-cookie-is-provided-to-the-user-after-accepting-the-License-Agreementand-is-necessary-for-accessing-the-Java-packages-in-download-oracle-com-The-previous-and-first-implementation-in-27th-March-2012-made-use-of-the-cookie-gpw-e24-http-3A-2F-2Fwww-oracle-com-…-Both-cases-remain-unannounced-to-the-public" class="headerlink" title="Since 15th March 2014 this cookie is provided to the user after accepting the License Agreementand is necessary for accessing the Java packages in download.oracle.com. The previous (and first) implementation in 27th March 2012 made use of the cookie gpw_e24=http%3A%2F%2Fwww.oracle.com[…]. Both cases remain unannounced to the public."></a>Since 15th March 2014 this cookie is provided to the user after accepting the License Agreementand is necessary for accessing the Java packages in download.oracle.com. The previous (and first) implementation in 27th March 2012 made use of the cookie gpw_e24=http%3A%2F%2Fwww.oracle.com[…]. Both cases remain unannounced to the public.</h5><h5 id="The-value-doesn’t-have-to-be-“accept-securebackup-cookie“"><a href="#The-value-doesn’t-have-to-be-“accept-securebackup-cookie“" class="headerlink" title="The value doesn’t have to be “accept-securebackup-cookie“."></a>The value doesn’t have to be “accept-securebackup-cookie“.</h5>]]></content:encoded>
      
      <comments>http://blog.togal.org/2017/10/31/Linux%E4%B8%8B%E4%BD%BF%E7%94%A8wget%E4%BB%8E%E5%AE%98%E7%BD%91%E4%B8%8A%E4%B8%8B%E8%BD%BDOracle-JDK/#disqus_thread</comments>
    </item>
    
    <item>
      <title>Hello Hexo</title>
      <link>http://blog.togal.org/2017/10/24/hello-world/</link>
      <guid>http://blog.togal.org/2017/10/24/hello-world/</guid>
      <pubDate>Tue, 24 Oct 2017 10:55:13 GMT</pubDate>
      <description>
      
        &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
      
      </description>
      
      <content:encoded><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
]]></content:encoded>
      
      <comments>http://blog.togal.org/2017/10/24/hello-world/#disqus_thread</comments>
    </item>
    
    <item>
      <title>google hacking</title>
      <link>http://blog.togal.org/2017/10/24/google%20hacking/</link>
      <guid>http://blog.togal.org/2017/10/24/google%20hacking/</guid>
      <pubDate>Tue, 24 Oct 2017 10:55:13 GMT</pubDate>
      <description>
      
        &lt;ul&gt;
&lt;li&gt;alltitle &lt;/li&gt;
&lt;li&gt;intitle&lt;/li&gt;
&lt;li&gt;intext&lt;/li&gt;
&lt;li&gt;alltext&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&quot;all-要求输入的字符都匹配&quot;&gt;&lt;a href=&quot;#all-要求输入的字符都匹配&quot; class=&quot;hea
      
      </description>
      
      <content:encoded><![CDATA[<ul>
<li>alltitle </li>
<li>intitle</li>
<li>intext</li>
<li>alltext</li>
</ul>
<h5 id="all-要求输入的字符都匹配"><a href="#all-要求输入的字符都匹配" class="headerlink" title="all 要求输入的字符都匹配"></a>all 要求输入的字符都匹配</h5><ul>
<li>inurl</li>
<li><p>allurl</p>
<h5 id="inurl-id-1"><a href="#inurl-id-1" class="headerlink" title="inurl:?id=1"></a>inurl:?id=1</h5></li>
<li><p>site</p>
<h5 id="site-www-piao-com-查看网站的所有页面"><a href="#site-www-piao-com-查看网站的所有页面" class="headerlink" title="site:www.piao.com 查看网站的所有页面"></a>site:www.piao.com 查看网站的所有页面</h5></li>
<li><p>filetype</p>
<h5 id="支持的类型有ppt-xls-doc-rtf-swf-pdf-kmz-kml-ps-def-txt-wps-flv-fla，不支持音乐格式的搜索"><a href="#支持的类型有ppt-xls-doc-rtf-swf-pdf-kmz-kml-ps-def-txt-wps-flv-fla，不支持音乐格式的搜索" class="headerlink" title="支持的类型有ppt xls doc rtf swf pdf kmz kml ps def txt wps flv fla，不支持音乐格式的搜索"></a>支持的类型有ppt xls doc rtf swf pdf kmz kml ps def txt wps flv fla，不支持音乐格式的搜索</h5></li>
<li><p>link</p>
<h5 id="查询链接到搜索网站的网页"><a href="#查询链接到搜索网站的网页" class="headerlink" title="查询链接到搜索网站的网页"></a>查询链接到搜索网站的网页</h5></li>
<li><p>numrange</p>
<h5 id="numrange-a-b-或者-numrange-a-b，a、b均为数字"><a href="#numrange-a-b-或者-numrange-a-b，a、b均为数字" class="headerlink" title="numrange:a-b 或者 numrange:a..b，a、b均为数字"></a>numrange:a-b 或者 numrange:a..b，a、b均为数字</h5><h5 id="比如电视剧的21集到30集"><a href="#比如电视剧的21集到30集" class="headerlink" title="比如电视剧的21集到30集"></a>比如电视剧的21集到30集</h5></li>
<li><p>info</p>
<h5 id="查到一个站点的摘要信息"><a href="#查到一个站点的摘要信息" class="headerlink" title="查到一个站点的摘要信息"></a>查到一个站点的摘要信息</h5></li>
<li><p>related</p>
<h5 id="搜索类似的网站"><a href="#搜索类似的网站" class="headerlink" title="搜索类似的网站"></a>搜索类似的网站</h5></li>
<li><p>index of</p>
<h5 id="目录搜索-intitle-index-of-admin"><a href="#目录搜索-intitle-index-of-admin" class="headerlink" title="目录搜索  intitle:index.of.admin"></a>目录搜索  intitle:index.of.admin</h5></li>
<li><p>anthor</p>
<h5 id="搜索作者"><a href="#搜索作者" class="headerlink" title="搜索作者"></a>搜索作者</h5></li>
<li><p>define</p>
<h5 id="字词定义"><a href="#字词定义" class="headerlink" title="字词定义"></a>字词定义</h5></li>
</ul>
]]></content:encoded>
      
      <comments>http://blog.togal.org/2017/10/24/google%20hacking/#disqus_thread</comments>
    </item>
    
  </channel>
</rss>
